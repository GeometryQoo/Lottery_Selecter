# å½©ç¥¨è³‡æ–™åº«ç³»çµ±

å°ç£å½©ç¥¨ï¼ˆå¤§æ¨‚é€ã€å¨åŠ›å½©ã€ä»Šå½©539ï¼‰æ­·å¹´é–‹çè³‡æ–™ç®¡ç†èˆ‡çµ±è¨ˆåˆ†æç³»çµ±ã€‚

## ğŸ“Š è³‡æ–™åº«è¨­è¨ˆ

æ¡ç”¨**æ­£è¦åŒ–è¨­è¨ˆ**ï¼ˆæ–¹æ¡ˆ Bï¼‰ï¼Œå°‡é–‹çè¨˜éŒ„èˆ‡è™Ÿç¢¼åˆ†é–‹å„²å­˜ï¼š

### è³‡æ–™è¡¨çµæ§‹

#### 1. lottery_drawsï¼ˆé–‹çè¨˜éŒ„è¡¨ï¼‰
- **id**: ä¸»éµï¼ˆè‡ªå‹•éå¢ï¼‰
- **game_type**: å½©ç¥¨é¡å‹ï¼ˆ'å¤§æ¨‚é€', 'å¨åŠ›å½©', 'ä»Šå½©539'ï¼‰
- **draw_number**: æœŸåˆ¥ï¼ˆä¾‹å¦‚ï¼š96000001ï¼‰
- **draw_date**: é–‹çæ—¥æœŸ
- **sales_amount**: éŠ·å”®ç¸½é¡
- **sales_bets**: éŠ·å”®æ³¨æ•¸
- **total_prize**: ç¸½çé‡‘
- **year**: å¹´ä»½ï¼ˆç”¨æ–¼å¿«é€Ÿç¯©é¸ï¼‰
- **created_at / updated_at**: æ™‚é–“æˆ³è¨˜

**å”¯ä¸€ç´„æŸ**: `(game_type, draw_number)` çµ„åˆå”¯ä¸€

#### 2. lottery_numbersï¼ˆè™Ÿç¢¼è¡¨ï¼‰
- **id**: ä¸»éµï¼ˆè‡ªå‹•éå¢ï¼‰
- **draw_id**: å¤–éµé—œè¯åˆ° lottery_draws
- **number**: è™Ÿç¢¼å€¼ï¼ˆ1-49 æˆ– 1-39ï¼‰
- **number_type**: è™Ÿç¢¼é¡å‹ï¼ˆ'main' ä¸»è™Ÿç¢¼, 'special' ç‰¹åˆ¥è™Ÿ/ç¬¬äºŒå€ï¼‰
- **position**: è™Ÿç¢¼ä½ç½®ï¼ˆ1-6ï¼‰

### è¨­è¨ˆå„ªå‹¢

âœ… **çµ±è¨ˆåˆ†æå„ªç•°**: æŸ¥è©¢è™Ÿç¢¼å‡ºç¾é »ç‡åªéœ€ç°¡å–®çš„ COUNT æŸ¥è©¢
âœ… **å½ˆæ€§æ“´å……**: æ–°å¢å½©ç¥¨é¡å‹ç„¡éœ€ä¿®æ”¹çµæ§‹
âœ… **è³‡æ–™å®Œæ•´æ€§**: å¤–éµç´„æŸç¢ºä¿è³‡æ–™ä¸€è‡´æ€§
âœ… **æŸ¥è©¢å„ªåŒ–**: é‡å°æ€§ç´¢å¼•åŠ é€Ÿå¸¸ç”¨æŸ¥è©¢

---

## ğŸ“ æª”æ¡ˆçµæ§‹

```
lottery/
â”œâ”€â”€ lottery.db               # SQLite è³‡æ–™åº«æª”æ¡ˆ
â”œâ”€â”€ import_lottery_data.py   # è³‡æ–™åŒ¯å…¥ç¨‹å¼
â”œâ”€â”€ query_examples.py        # æŸ¥è©¢ç¯„ä¾‹èˆ‡çµ±è¨ˆåˆ†æ
â”œâ”€â”€ lottery_data/            # CSV åŸå§‹è³‡æ–™
â”‚   â”œâ”€â”€ 2007/
â”‚   â”‚   â”œâ”€â”€ å¤§æ¨‚é€_2007.csv
â”‚   â”‚   â”œâ”€â”€ ä»Šå½©539_2007.csv
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ 2008/
â”‚   â”‚   â”œâ”€â”€ å¤§æ¨‚é€_2008.csv
â”‚   â”‚   â”œâ”€â”€ å¨åŠ›å½©_2008.csv  # å¨åŠ›å½©å¾2008å¹´é–‹å§‹
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ ...
â””â”€â”€ README.md                # å°ˆæ¡ˆèªªæ˜æ–‡ä»¶
```

---

## ğŸš€ å¿«é€Ÿé–‹å§‹

### 1. åŒ¯å…¥è³‡æ–™

é¦–æ¬¡ä½¿ç”¨éœ€è¦å…ˆåŒ¯å…¥ CSV è³‡æ–™åˆ°è³‡æ–™åº«ï¼š

```bash
python3 import_lottery_data.py
```

**åŒ¯å…¥çµ±è¨ˆ**:
- å¤§æ¨‚é€: 2,056 ç­†è¨˜éŒ„ï¼ˆ2007-2025ï¼‰
- å¨åŠ›å½©: 1,742 ç­†è¨˜éŒ„ï¼ˆ2008-2025ï¼‰
- ä»Šå½©539: 5,352 ç­†è¨˜éŒ„ï¼ˆ2007-2025ï¼‰
- è™Ÿç¢¼è¨˜éŒ„ç¸½æ•¸: 53,346 ç­†

### 2. æŸ¥è©¢ç¯„ä¾‹

åŸ·è¡ŒæŸ¥è©¢ç¯„ä¾‹è…³æœ¬æŸ¥çœ‹çµ±è¨ˆåˆ†æåŠŸèƒ½ï¼š

```bash
python3 query_examples.py
```

---

## ğŸ“ˆ æŸ¥è©¢åŠŸèƒ½

### å…§å»ºæŸ¥è©¢æ–¹æ³•

#### 1. è™Ÿç¢¼å‡ºç¾é »ç‡
```python
from query_examples import LotteryQuery

with LotteryQuery() as query:
    # æŸ¥è©¢å¤§æ¨‚é€è™Ÿç¢¼å‡ºç¾é »ç‡ï¼ˆå‰10åï¼‰
    freq = query.get_number_frequency('å¤§æ¨‚é€', 'main', limit=10)
    for number, count in freq:
        print(f"è™Ÿç¢¼ {number} å‡ºç¾ {count} æ¬¡")
```

#### 2. æœ€è¿‘é–‹çè¨˜éŒ„
```python
with LotteryQuery() as query:
    # æŸ¥è©¢æœ€è¿‘5æœŸé–‹ç
    latest = query.get_latest_draws('å¨åŠ›å½©', limit=5)
    for draw in latest:
        print(f"æœŸåˆ¥: {draw['draw_number']}")
        print(f"è™Ÿç¢¼: {draw['main_numbers']} + {draw['special_numbers']}")
```

#### 3. å†·ç†±è™Ÿç¢¼åˆ†æ
```python
with LotteryQuery() as query:
    # æŸ¥è©¢ä»Šå½©539æœ€è¿‘100æœŸçš„å†·ç†±è™Ÿç¢¼
    result = query.get_cold_hot_numbers('ä»Šå½©539', recent_draws=100)
    print("ç†±è™Ÿ:", result['hot_numbers'])
    print("å†·è™Ÿ:", result['cold_numbers'])
```

#### 4. å¹´åº¦çµ±è¨ˆ
```python
with LotteryQuery() as query:
    # æŸ¥è©¢å¨åŠ›å½©å„å¹´ä»½çµ±è¨ˆ
    stats = query.get_statistics_by_year('å¨åŠ›å½©')
    for stat in stats:
        print(f"{stat['year']}: {stat['draw_count']}æœŸ, ç¸½çé‡‘ ${stat['total_prize']:,}")
```

#### 5. è™Ÿç¢¼çµ„åˆæŸ¥è©¢
```python
with LotteryQuery() as query:
    # æŸ¥è©¢ç‰¹å®šè™Ÿç¢¼çµ„åˆåŒæ™‚å‡ºç¾çš„æ¬¡æ•¸
    count = query.get_number_combination_frequency('å¤§æ¨‚é€', [1, 2, 3])
    print(f"è™Ÿç¢¼ 1, 2, 3 åŒæ™‚å‡ºç¾ {count} æ¬¡")
```

---

## ğŸ” SQL æŸ¥è©¢ç¯„ä¾‹

### æŸ¥è©¢ç‰¹å®šæœŸåˆ¥å®Œæ•´è³‡è¨Š
```sql
SELECT d.*,
       GROUP_CONCAT(CASE WHEN n.number_type = 'main' THEN n.number END) as main_numbers,
       GROUP_CONCAT(CASE WHEN n.number_type = 'special' THEN n.number END) as special_numbers
FROM lottery_draws d
LEFT JOIN lottery_numbers n ON d.id = n.draw_id
WHERE d.game_type = 'å¤§æ¨‚é€' AND d.draw_number = '96000001'
GROUP BY d.id;
```

### æŸ¥è©¢2023å¹´ç¸½éŠ·å”®é¡
```sql
SELECT game_type,
       COUNT(*) as total_draws,
       SUM(sales_amount) as total_sales,
       AVG(sales_amount) as avg_sales
FROM lottery_draws
WHERE year = 2023
GROUP BY game_type;
```

### æŸ¥è©¢è™Ÿç¢¼23å‡ºç¾çš„æ‰€æœ‰æœŸåˆ¥
```sql
SELECT d.game_type, d.draw_number, d.draw_date
FROM lottery_draws d
JOIN lottery_numbers n ON d.id = n.draw_id
WHERE n.number = 23 AND n.number_type = 'main'
ORDER BY d.draw_date DESC;
```

---

## ğŸ“Š è³‡æ–™çµ±è¨ˆ

### å„å½©ç¥¨é¡å‹è³‡æ–™é‡

| å½©ç¥¨é¡å‹ | æœŸæ•¸ | å¹´ä»½ç¯„åœ | å¹³å‡æ¯å¹´æœŸæ•¸ |
|---------|------|---------|-------------|
| å¤§æ¨‚é€   | 2,056 | 2007-2025 | ~108 æœŸ/å¹´ |
| å¨åŠ›å½©   | 1,742 | 2008-2025 | ~104 æœŸ/å¹´ |
| ä»Šå½©539  | 5,352 | 2007-2025 | ~297 æœŸ/å¹´ |

### è™Ÿç¢¼çµæ§‹

- **å¤§æ¨‚é€**: 6å€‹ä¸»è™Ÿç¢¼ + 1å€‹ç‰¹åˆ¥è™Ÿï¼ˆç¯„åœ 1-49ï¼‰
- **å¨åŠ›å½©**: 6å€‹ä¸»è™Ÿç¢¼ï¼ˆ1-38ï¼‰+ 1å€‹ç¬¬äºŒå€è™Ÿç¢¼ï¼ˆ1-8ï¼‰
- **ä»Šå½©539**: 5å€‹ä¸»è™Ÿç¢¼ï¼ˆç¯„åœ 1-39ï¼‰

---

## ğŸ›  æŠ€è¡“è¦æ ¼

- **è³‡æ–™åº«**: SQLite 3
- **ç¨‹å¼èªè¨€**: Python 3
- **è³‡æ–™æ ¼å¼**: CSV (UTF-8 with BOM)
- **è³‡æ–™åº«æª”æ¡ˆå¤§å°**: ç´„ 5 MB

---

## ğŸ“ æ³¨æ„äº‹é …

1. **ç¼ºå¤±è³‡æ–™**:
   - å¨åŠ›å½©å¾ 2008 å¹´é–‹å§‹ï¼ˆ2007 å¹´ç„¡è³‡æ–™ï¼‰
   - 2021 å¹´ç¼ºå°‘å¨åŠ›å½©å’Œä»Šå½©539è³‡æ–™
   - 2024-2025 å¹´ä»Šå½©539è³‡æ–™ä¸å®Œæ•´

2. **æœŸåˆ¥æ ¼å¼**:
   - æ ¼å¼ï¼š`{æ°‘åœ‹å¹´}{æµæ°´è™Ÿ}`
   - ä¾‹å¦‚ï¼š96000001 = æ°‘åœ‹96å¹´ç¬¬1æœŸï¼ˆè¥¿å…ƒ2007å¹´ï¼‰

3. **é‡è¤‡åŒ¯å…¥**:
   - åŒ¯å…¥ç¨‹å¼æœƒè‡ªå‹•æ›´æ–°å·²å­˜åœ¨çš„è¨˜éŒ„
   - å¦‚éœ€å®Œå…¨é‡æ–°åŒ¯å…¥ï¼Œè«‹å…ˆåˆªé™¤ `lottery.db` æª”æ¡ˆ

---

## ğŸ“š æ“´å……å»ºè­°

### å¯æ–°å¢çš„åŠŸèƒ½

1. **é€²éšçµ±è¨ˆåˆ†æ**
   - è™Ÿç¢¼é–“éš”åˆ†æï¼ˆä¸Šæ¬¡å‡ºç¾åˆ°æœ¬æ¬¡çš„é–“éš”æœŸæ•¸ï¼‰
   - å¥‡å¶æ¯”ä¾‹åˆ†æ
   - å¤§å°è™Ÿæ¯”ä¾‹åˆ†æ
   - é€£è™Ÿå‡ºç¾é »ç‡

2. **è¦–è¦ºåŒ–åœ–è¡¨**
   - è™Ÿç¢¼å‡ºç¾è¶¨å‹¢åœ–
   - éŠ·å”®é¡/çé‡‘èµ°å‹¢åœ–
   - å†·ç†±è™Ÿç¢¼ç†±åŠ›åœ–

3. **é æ¸¬æ¨¡å‹**
   - åŸºæ–¼æ­·å²è³‡æ–™çš„è™Ÿç¢¼æ¨è–¦
   - æ©Ÿå™¨å­¸ç¿’æ¨¡å‹è¨“ç·´

4. **API æœå‹™**
   - RESTful API æä¾›æŸ¥è©¢æœå‹™
   - Web ä»‹é¢å±•ç¤ºçµ±è¨ˆçµæœ

---

## ğŸ“„ æˆæ¬Š

æœ¬å°ˆæ¡ˆåƒ…ä¾›å€‹äººå­¸ç¿’èˆ‡ç ”ç©¶ä½¿ç”¨ã€‚è³‡æ–™ä¾†æºè«‹åƒè€ƒå°ç£å½©åˆ¸å®˜æ–¹ç¶²ç«™ã€‚

---

## ğŸ¯ ç¸½çµ

æœ¬ç³»çµ±æä¾›å®Œæ•´çš„å½©ç¥¨è³‡æ–™ç®¡ç†èˆ‡çµ±è¨ˆåˆ†æåŠŸèƒ½ï¼Œæ¡ç”¨æ­£è¦åŒ–è³‡æ–™åº«è¨­è¨ˆç¢ºä¿è³‡æ–™å®Œæ•´æ€§èˆ‡æŸ¥è©¢æ•ˆèƒ½ã€‚é€é Python ä»‹é¢å¯è¼•é¬†é€²è¡Œå„ç¨®çµ±è¨ˆåˆ†æï¼Œé©åˆç”¨æ–¼è³‡æ–™åˆ†æå­¸ç¿’èˆ‡ç ”ç©¶ã€‚
